\newkeycommand{\model}[x = 0cm, y = 0cm, width = 3.4cm, height = 1.8cm, name = model][1]{
\node[fill = white, cylinder, shape border rotate = 90, draw, minimum height = \commandkey{height}, minimum width = \commandkey{width}, align = center, shape aspect=2] (\commandkey{name}) at (\commandkey{x}, \commandkey{y}) {};

\draw[dashed, line width = 0.5pt]
let \p1 = ($ (\commandkey{name}.after bottom) - (\commandkey{name}.before bottom) $),
    \n1 = {0.5*veclen(\x1,\y1)-\pgflinewidth},
    \p2 = ($ (\commandkey{name}.bottom) - (\commandkey{name}.after bottom)!.5!(\commandkey{name}.before bottom) $),
    \n2 = {veclen(\x2,\y2)-\pgflinewidth}
in
    ([xshift=-\pgflinewidth] \commandkey{name}.before bottom) arc [start angle=0, end angle=180,
    x radius=\n1, y radius=\n2];

\coordinate (\commandkey{name}BottomCenter) at ($(\commandkey{name}.after bottom)!0.5!(\commandkey{name}.before bottom)$);
\coordinate (\commandkey{name}TopCenter) at ($(\commandkey{name}.after top)!0.5!(\commandkey{name}.before top)$);

\node at (\commandkey{x}, \commandkey{y}) [fill = white, align = center, inner sep = 1pt] {#1};
}

\newkeycommand{\lefttag}[x = 0cm, y = 0cm, width = 3cm][1]{
\node at (\commandkey{x} + 4pt, \commandkey{y}) [text shadow={[align=left, inner sep = 0pt, font = \small, anchor = west] at (\commandkey{x} + 4pt, \commandkey{y}) {\parbox{\commandkey{width}}{#1}}}, align = left, inner sep = 0pt, font = \small, anchor = west] {\parbox{\commandkey{width}}{#1}};
}

\begin{tikzpicture}[line width = 1pt,
                    block/.style = {draw, rectangle, fill =white, minimum width = 2cm, minimum height = 1.4cm, inner sep = 0pt, align = center},
                    cup/.style = {fill = black, circle, inner sep = 0pt, minimum size = 0.5cm, text = white},
                    line/.style = {draw = white, line width = 3pt}]

% \draw (0, 0) to[grid with coordinates]  (14, 9);
\linespread{1}

\fill[rounded corners, black!30] (3.8, 3.1) rectangle (11.7, 8.9);
\shadowtext[align = center] at (10.1, 7.7) {\Large \bf Data\\[5pt] \Large \bf Filter};
\pause

\node[block] (AI) at (5, 8) {Attack\\Evidences\\Pool};
\node[block] (FI) at (5, 6) {Invalidation\\Evidence\\Identifier};
\node[block] (II) at (5, 4) {Incident\\Evidence\\Identifier};
\pause

\uncover<3>{
\draw[<-] (AI) -- ++ (180:5cm);
\draw[<-] (FI) -- ++ (180:5cm);
\draw[<-] (II) -- ++ (180:5cm);
}
\shadowtext[align = left, anchor = west] at (0, 8) {Attack\\Evidences};
\shadowtext[align = left, anchor = west] at (0, 6) {Real-time\\Data};
\shadowtext[align = left, anchor = west] at (0, 4) {Real-time\\Data};
\pause

\node[cup] (CUP1) at (2, 6) {$\bm{+}$};
\node[cup] (CUP2) at (3, 4) {$\bm{+}$};
\model[x = 2.5cm, y = 1.5cm, width = 2.5cm, name = HD]{Historical\\Database};

\draw[<-] (CUP1) -- ++(180:2cm);
\draw[<-] (CUP2) -- ++(180:3cm);
\draw[->] (CUP1) -- (FI);
\draw[->] (CUP2) -- (II);
\draw[<-] (AI) -- ++(180:5cm);
\draw[line] (HDTopCenter -| CUP1) -- (CUP1);
\draw[line] (HDTopCenter -| CUP2) -- (CUP2);
\draw[->] (HDTopCenter -| CUP1) -- (CUP1);
\draw[->] (HDTopCenter -| CUP2) -- (CUP2);
\pause

\uncover<5>{
\draw[->] (AI) -- ++ (0:3.5cm);
\draw[->] (FI) -- ++ (0:3.5cm);
\draw[->] (II) -- ++ (0:3.5cm);
}
\shadowtext[align = left, anchor = west] at (6, 8) {Attack\\Evidences};
\shadowtext[align = left, anchor = west] at (6, 6) {Invalidation\\Evidences};
\shadowtext[align = left, anchor = west] at (6, 4) {Incident\\Evidences};

\pause

\node[block] (NF) at (10.5, 6) {Noise\\Filter};
\node[cup] (CUP3) at (8.5, 6) {$\bm{+}$};
\draw[->] (AI) -| (CUP3);
\draw[->] (FI) -- (CUP3);
\draw[->] (II) -| (CUP3);
\draw[->] (CUP3) -- (NF);
\pause

\model[x = 10.5cm, y = 1.5cm, width = 2cm, name = CT]{Causal\\Model};
\draw[line] (CTTopCenter) -- ++(90:0.5cm);
\draw[->] (CTTopCenter) -- (NF);
\pause

\draw[->] (NF) -- ++(0:3cm);
\shadowtext[align = center] at (12.6, 6) {Evidence\\Set $\bm{E}$};
\end{tikzpicture} 